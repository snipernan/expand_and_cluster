Generating dataset with teacher...
train	ep 00000	it 000	loss 3.711e+00	ex 8000	time 0.00s
train	ep 00100	it 000	loss 1.159e-03	ex 8000	time 6.65s
train	ep 00200	it 000	loss 4.394e-04	ex 8000	time 8.71s
train	ep 00300	it 000	loss 7.270e-05	ex 8000	time 8.31s
train	ep 00400	it 000	loss 1.708e-05	ex 8000	time 7.91s
train	ep 00500	it 000	loss 6.927e-06	ex 8000	time 8.01s
train	ep 00600	it 000	loss 3.910e-06	ex 8000	time 7.93s
train	ep 00700	it 000	loss 4.596e-06	ex 8000	time 7.92s
train	ep 00800	it 000	loss 3.393e-06	ex 8000	time 7.87s
train	ep 00900	it 000	loss 1.692e-06	ex 8000	time 7.92s
train	ep 01000	it 000	loss 1.077e-05	ex 8000	time 7.89s
train	ep 01100	it 000	loss 1.301e-06	ex 8000	time 7.78s
train	ep 01200	it 000	loss 2.874e-06	ex 8000	time 7.84s
train	ep 01300	it 000	loss 1.861e-06	ex 8000	time 7.52s
train	ep 01400	it 000	loss 5.760e-06	ex 8000	time 7.73s
train	ep 01500	it 000	loss 4.821e-06	ex 8000	time 8.12s
train	ep 01600	it 000	loss 1.088e-05	ex 8000	time 8.04s
train	ep 01700	it 000	loss 1.256e-06	ex 8000	time 8.03s
train	ep 01800	it 000	loss 7.887e-07	ex 8000	time 8.02s
train	ep 01900	it 000	loss 4.196e-06	ex 8000	time 8.25s
train	ep 02000	it 000	loss 3.466e-06	ex 8000	time 8.10s
train	ep 02100	it 000	loss 6.229e-06	ex 8000	time 7.90s
train	ep 02200	it 000	loss 5.040e-06	ex 8000	time 8.02s
train	ep 02300	it 000	loss 3.826e-06	ex 8000	time 7.93s
train	ep 02400	it 000	loss 5.647e-06	ex 8000	time 7.97s
train	ep 02500	it 000	loss 1.283e-06	ex 8000	time 7.85s
train	ep 02600	it 000	loss 2.023e-06	ex 8000	time 8.13s
train	ep 02700	it 000	loss 4.978e-06	ex 8000	time 8.01s
train	ep 02800	it 000	loss 8.188e-06	ex 8000	time 8.13s
train	ep 02900	it 000	loss 3.326e-06	ex 8000	time 8.03s
train	ep 03000	it 000	loss 8.198e-06	ex 8000	time 7.84s
train	ep 03100	it 000	loss 3.078e-06	ex 8000	time 8.05s
train	ep 03200	it 000	loss 7.023e-06	ex 8000	time 8.02s
train	ep 03300	it 000	loss 3.274e-06	ex 8000	time 8.18s
train	ep 03400	it 000	loss 8.935e-07	ex 8000	time 8.06s
train	ep 03500	it 000	loss 4.918e-06	ex 8000	time 7.66s
train	ep 03600	it 000	loss 1.523e-06	ex 8000	time 7.12s
train	ep 03700	it 000	loss 1.795e-06	ex 8000	time 7.18s
train	ep 03800	it 000	loss 1.560e-06	ex 8000	time 7.31s
train	ep 03900	it 000	loss 1.968e-06	ex 8000	time 7.35s
train	ep 04000	it 000	loss 2.171e-06	ex 8000	time 7.15s
train	ep 04100	it 000	loss 3.023e-06	ex 8000	time 7.16s
train	ep 04200	it 000	loss 3.648e-06	ex 8000	time 7.05s
train	ep 04300	it 000	loss 8.166e-06	ex 8000	time 7.09s
train	ep 04400	it 000	loss 2.657e-06	ex 8000	time 8.22s
train	ep 04500	it 000	loss 3.723e-06	ex 8000	time 8.21s
train	ep 04600	it 000	loss 7.730e-06	ex 8000	time 7.04s
train	ep 04700	it 000	loss 2.426e-06	ex 8000	time 6.93s
train	ep 04800	it 000	loss 1.831e-06	ex 8000	time 7.60s
train	ep 04900	it 000	loss 2.746e-06	ex 8000	time 7.33s
train	ep 05000	it 000	loss 7.715e-07	ex 8000	time 7.48s
train	ep 05100	it 000	loss 1.984e-06	ex 8000	time 7.37s
train	ep 05200	it 000	loss 1.044e-06	ex 8000	time 7.39s
train	ep 05300	it 000	loss 8.840e-07	ex 8000	time 7.34s
train	ep 05400	it 000	loss 1.170e-06	ex 8000	time 7.46s
train	ep 05500	it 000	loss 6.988e-07	ex 8000	time 7.57s
train	ep 05600	it 000	loss 2.619e-06	ex 8000	time 7.26s
train	ep 05700	it 000	loss 2.622e-06	ex 8000	time 7.19s
train	ep 05800	it 000	loss 1.442e-06	ex 8000	time 7.40s
train	ep 05900	it 000	loss 1.505e-06	ex 8000	time 7.42s
train	ep 06000	it 000	loss 3.145e-06	ex 8000	time 6.68s
train	ep 06100	it 000	loss 2.809e-06	ex 8000	time 6.59s
train	ep 06200	it 000	loss 4.095e-06	ex 8000	time 6.59s
train	ep 06300	it 000	loss 1.397e-06	ex 8000	time 6.52s
train	ep 06400	it 000	loss 1.283e-06	ex 8000	time 6.91s
train	ep 06500	it 000	loss 4.815e-07	ex 8000	time 7.08s
train	ep 06600	it 000	loss 5.335e-06	ex 8000	time 7.02s
train	ep 06700	it 000	loss 4.571e-06	ex 8000	time 6.99s
train	ep 06800	it 000	loss 7.115e-06	ex 8000	time 6.92s
train	ep 06900	it 000	loss 4.056e-06	ex 8000	time 6.93s
train	ep 07000	it 000	loss 4.833e-06	ex 8000	time 6.98s
train	ep 07100	it 000	loss 2.674e-06	ex 8000	time 6.99s
train	ep 07200	it 000	loss 4.635e-06	ex 8000	time 6.82s
train	ep 07300	it 000	loss 1.792e-07	ex 8000	time 6.61s
train	ep 07400	it 000	loss 1.713e-06	ex 8000	time 6.76s
train	ep 07500	it 000	loss 1.252e-06	ex 8000	time 6.67s
train	ep 07600	it 000	loss 4.296e-06	ex 8000	time 6.57s
train	ep 07700	it 000	loss 7.130e-07	ex 8000	time 6.73s
train	ep 07800	it 000	loss 1.520e-06	ex 8000	time 6.72s
train	ep 07900	it 000	loss 1.784e-06	ex 8000	time 6.46s
train	ep 08000	it 000	loss 3.779e-06	ex 8000	time 6.64s
train	ep 08100	it 000	loss 2.144e-06	ex 8000	time 6.55s
train	ep 08200	it 000	loss 2.495e-06	ex 8000	time 6.54s
train	ep 08300	it 000	loss 7.377e-07	ex 8000	time 6.55s
train	ep 08400	it 000	loss 4.212e-06	ex 8000	time 6.67s
train	ep 08500	it 000	loss 7.299e-07	ex 8000	time 6.78s
train	ep 08600	it 000	loss 2.828e-06	ex 8000	time 6.78s
train	ep 08700	it 000	loss 2.361e-06	ex 8000	time 6.78s
train	ep 08800	it 000	loss 4.342e-06	ex 8000	time 6.67s
train	ep 08900	it 000	loss 2.079e-06	ex 8000	time 6.68s
train	ep 09000	it 000	loss 3.178e-07	ex 8000	time 6.60s
train	ep 09100	it 000	loss 9.271e-07	ex 8000	time 6.60s
train	ep 09200	it 000	loss 4.496e-06	ex 8000	time 6.78s
train	ep 09300	it 000	loss 1.558e-06	ex 8000	time 6.57s
train	ep 09400	it 000	loss 2.516e-06	ex 8000	time 6.69s
train	ep 09500	it 000	loss 4.755e-06	ex 8000	time 6.89s
train	ep 09600	it 000	loss 1.314e-06	ex 8000	time 6.69s
train	ep 09700	it 000	loss 2.745e-06	ex 8000	time 6.68s
train	ep 09800	it 000	loss 4.851e-06	ex 8000	time 6.78s
train	ep 09900	it 000	loss 3.642e-06	ex 8000	time 6.78s
train	ep 10000	it 000	loss 6.688e-06	ex 8000	time 7.42s
============================================================================================================================================
Reconstruction
--------------------------------------------------------------------------------------------------------------------------------------------
Reconstruction Location: /home/alvin/expand-and-cluster/data/sims/ec_333b6be3fa/seed_-1/main/clustering_a48fe7727a
--------------------------------------------------------------------------------------------------------------------------------------------

Generating dataset with teacher...
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 0
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 21 of size bigger than 4.0.
removing 11/21 unaligned clusters
Collapsing 10 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':
#0->1, #1->4, #2->3, #3->1, #4->1, #5->5, #6->1, #7->4, #8->1, #9->1,
Final layer size: 10

train	ep 00000	it 000	loss 2.836e+00	ex 8000	time 0.00s
train	ep 00100	it 000	loss 2.790e-02	ex 8000	time 7.98s
train	ep 00200	it 000	loss 7.911e-03	ex 8000	time 7.27s
train	ep 00300	it 000	loss 2.729e-03	ex 8000	time 7.44s
train	ep 00400	it 000	loss 7.224e-04	ex 8000	time 7.67s
train	ep 00500	it 000	loss 2.425e-04	ex 8000	time 7.22s
train	ep 00600	it 000	loss 1.344e-04	ex 8000	time 7.18s
train	ep 00700	it 000	loss 7.729e-05	ex 8000	time 7.56s
train	ep 00800	it 000	loss 4.379e-05	ex 8000	time 7.52s
train	ep 00900	it 000	loss 2.346e-05	ex 8000	time 7.20s
train	ep 01000	it 000	loss 1.552e-05	ex 8000	time 7.38s
train	ep 01100	it 000	loss 1.123e-05	ex 8000	time 7.39s
train	ep 01200	it 000	loss 7.513e-06	ex 8000	time 6.59s
train	ep 01300	it 000	loss 3.690e-06	ex 8000	time 6.73s
train	ep 01400	it 000	loss 1.600e-06	ex 8000	time 6.46s
train	ep 01500	it 000	loss 9.190e-07	ex 8000	time 6.77s
train	ep 01600	it 000	loss 6.940e-07	ex 8000	time 7.10s
train	ep 01700	it 000	loss 5.781e-07	ex 8000	time 7.08s
train	ep 01800	it 000	loss 4.610e-07	ex 8000	time 6.85s
train	ep 01900	it 000	loss 3.775e-07	ex 8000	time 6.87s
train	ep 02000	it 000	loss 3.628e-07	ex 8000	time 7.16s
train	ep 02100	it 000	loss 3.025e-07	ex 8000	time 6.96s
train	ep 02200	it 000	loss 2.636e-07	ex 8000	time 6.99s
train	ep 02300	it 000	loss 2.544e-07	ex 8000	time 6.79s
train	ep 02400	it 000	loss 2.342e-07	ex 8000	time 6.79s
train	ep 02500	it 000	loss 2.275e-07	ex 8000	time 6.72s
train	ep 02600	it 000	loss 1.990e-07	ex 8000	time 6.79s
train	ep 02700	it 000	loss 1.847e-07	ex 8000	time 6.60s
train	ep 02800	it 000	loss 1.694e-07	ex 8000	time 6.70s
train	ep 02900	it 000	loss 1.853e-07	ex 8000	time 6.71s
train	ep 03000	it 000	loss 1.733e-07	ex 8000	time 6.73s
train	ep 03100	it 000	loss 1.650e-07	ex 8000	time 6.83s
train	ep 03200	it 000	loss 1.683e-07	ex 8000	time 6.92s
train	ep 03300	it 000	loss 1.641e-07	ex 8000	time 6.73s
train	ep 03400	it 000	loss 1.465e-07	ex 8000	time 6.74s
train	ep 03500	it 000	loss 1.603e-07	ex 8000	time 6.67s
train	ep 03600	it 000	loss 1.498e-07	ex 8000	time 6.70s
train	ep 03700	it 000	loss 1.342e-07	ex 8000	time 6.61s
train	ep 03800	it 000	loss 1.331e-07	ex 8000	time 6.63s
train	ep 03900	it 000	loss 1.439e-07	ex 8000	time 6.97s
train	ep 04000	it 000	loss 1.277e-07	ex 8000	time 7.05s
train	ep 04100	it 000	loss 1.165e-07	ex 8000	time 6.90s
train	ep 04200	it 000	loss 1.230e-07	ex 8000	time 6.90s
train	ep 04300	it 000	loss 1.082e-07	ex 8000	time 6.99s
train	ep 04400	it 000	loss 1.138e-07	ex 8000	time 6.88s
train	ep 04500	it 000	loss 1.043e-07	ex 8000	time 6.98s
train	ep 04600	it 000	loss 1.163e-07	ex 8000	time 6.74s
train	ep 04700	it 000	loss 1.028e-07	ex 8000	time 6.97s
train	ep 04800	it 000	loss 1.161e-07	ex 8000	time 6.88s
train	ep 04900	it 000	loss 1.045e-07	ex 8000	time 6.87s
train	ep 05000	it 000	loss 1.330e-07	ex 8000	time 7.15s
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 1
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 15 of size bigger than 4.0.
removing 15/15 unaligned clusters
Collapsing 0 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':

Final layer size: 0
Traceback (most recent call last):
  File "/home/alvin/expand-and-cluster/EC.py", line 76, in <module>
    main()
  File "/home/alvin/expand-and-cluster/EC.py", line 72, in main
    platform.run_job(runner_registry.get(runner_name).create_from_args(args).run)
  File "/home/alvin/expand-and-cluster/platforms/base.py", line 130, in run_job
    f()
  File "/home/alvin/expand-and-cluster/extraction/runner.py", line 79, in run
    expand_and_cluster.reconstruct(students, losses, self.desc.extraction_path(self.global_seed),
  File "/home/alvin/expand-and-cluster/extraction/expand_and_cluster.py", line 175, in reconstruct
    w_rec = np.stack([w_rec]*N, axis=2)
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/numpy/core/shape_base.py", line 452, in stack
    axis = normalize_axis_index(axis, result_ndim)
numpy.exceptions.AxisError: axis 2 is out of bounds for array of dimension 2
