Generating dataset with teacher...
============================================================================================================================================
Reconstruction
--------------------------------------------------------------------------------------------------------------------------------------------
Reconstruction Location: /home/alvin/expand-and-cluster/data/sims/ec_6a716683e5/seed_-1/main/clustering_8389c857d6
--------------------------------------------------------------------------------------------------------------------------------------------

Generating dataset with teacher...
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 0
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 5 of size bigger than 25.0.
removing 2/5 unaligned clusters
Collapsing 3 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':
#0->1, #1->1, #2->1,
Final layer size: 3

train	ep 02800	it 000	loss 2.149e+01	ex 60000	time 0.00s
train	ep 02900	it 000	loss 2.144e+01	ex 60000	time 78.35s
train	ep 03000	it 000	loss 2.144e+01	ex 60000	time 72.73s
train	ep 03100	it 000	loss 2.139e+01	ex 60000	time 72.47s
train	ep 03200	it 000	loss 2.134e+01	ex 60000	time 76.27s
train	ep 03300	it 000	loss 2.132e+01	ex 60000	time 74.82s
train	ep 03400	it 000	loss 2.129e+01	ex 60000	time 79.31s
train	ep 03500	it 000	loss 2.124e+01	ex 60000	time 77.78s
train	ep 03600	it 000	loss 2.122e+01	ex 60000	time 75.35s
train	ep 03700	it 000	loss 2.122e+01	ex 60000	time 132.50s
train	ep 03800	it 000	loss 2.120e+01	ex 60000	time 174.67s
train	ep 03900	it 000	loss 2.120e+01	ex 60000	time 208.88s
train	ep 04000	it 000	loss 2.114e+01	ex 60000	time 220.54s
train	ep 04100	it 000	loss 2.112e+01	ex 60000	time 152.27s
train	ep 04200	it 000	loss 2.111e+01	ex 60000	time 241.56s
train	ep 04300	it 000	loss 2.110e+01	ex 60000	time 215.70s
train	ep 04400	it 000	loss 2.105e+01	ex 60000	time 192.76s
train	ep 04500	it 000	loss 2.103e+01	ex 60000	time 168.04s
train	ep 04600	it 000	loss 2.100e+01	ex 60000	time 167.67s
train	ep 04700	it 000	loss 2.100e+01	ex 60000	time 136.95s
train	ep 04800	it 000	loss 2.095e+01	ex 60000	time 186.22s
train	ep 04900	it 000	loss 2.091e+01	ex 60000	time 198.10s
train	ep 05000	it 000	loss 2.086e+01	ex 60000	time 230.99s
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 1
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 5 of size bigger than 25.0.
removing 5/5 unaligned clusters
Collapsing 0 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':

Final layer size: 0
Traceback (most recent call last):
  File "/home/alvin/expand-and-cluster/EC.py", line 76, in <module>
    main()
  File "/home/alvin/expand-and-cluster/EC.py", line 72, in main
    platform.run_job(runner_registry.get(runner_name).create_from_args(args).run)
  File "/home/alvin/expand-and-cluster/platforms/base.py", line 130, in run_job
    f()
  File "/home/alvin/expand-and-cluster/extraction/runner.py", line 79, in run
    expand_and_cluster.reconstruct(students, losses, self.desc.extraction_path(self.global_seed),
  File "/home/alvin/expand-and-cluster/extraction/expand_and_cluster.py", line 175, in reconstruct
    w_rec = np.stack([w_rec]*N, axis=2)
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/numpy/core/shape_base.py", line 452, in stack
    axis = normalize_axis_index(axis, result_ndim)
numpy.exceptions.AxisError: axis 2 is out of bounds for array of dimension 2
