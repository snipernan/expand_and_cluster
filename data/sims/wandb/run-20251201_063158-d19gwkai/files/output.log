Generating dataset with teacher...
============================================================================================================================================
Reconstruction
--------------------------------------------------------------------------------------------------------------------------------------------
Reconstruction Location: /root/expand_and_cluster/data/sims/ec_3c2502264b/seed_-1/main/clustering_561e138d6e
--------------------------------------------------------------------------------------------------------------------------------------------

Generating dataset with teacher...
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 0
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 13 of size bigger than 6.0.
removing 0/13 unaligned clusters
Collapsing 13 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':
#0->1, #1->3, #2->1, #4->2, #5->1, #6->1, #7->1, #8->1, #10->1, #11->2, #12->3,
Final layer size: 11

train	ep 00000	it 000	loss 1.561e+01	ex 10000	time 0.00s
train	ep 00100	it 000	loss 2.694e-01	ex 10000	time 7.00s
train	ep 00200	it 000	loss 8.490e-02	ex 10000	time 6.90s
train	ep 00300	it 000	loss 3.831e-02	ex 10000	time 6.83s
train	ep 00400	it 000	loss 2.114e-02	ex 10000	time 6.88s
train	ep 00500	it 000	loss 1.188e-02	ex 10000	time 6.87s
train	ep 00600	it 000	loss 6.860e-03	ex 10000	time 6.79s
train	ep 00700	it 000	loss 4.540e-03	ex 10000	time 6.83s
train	ep 00800	it 000	loss 3.511e-03	ex 10000	time 6.89s
train	ep 00900	it 000	loss 2.721e-03	ex 10000	time 6.75s
train	ep 01000	it 000	loss 2.231e-03	ex 10000	time 6.88s
train	ep 01100	it 000	loss 1.885e-03	ex 10000	time 6.87s
train	ep 01200	it 000	loss 1.513e-03	ex 10000	time 6.78s
train	ep 01300	it 000	loss 1.279e-03	ex 10000	time 6.86s
train	ep 01400	it 000	loss 1.157e-03	ex 10000	time 6.90s
train	ep 01500	it 000	loss 1.058e-03	ex 10000	time 6.79s
train	ep 01600	it 000	loss 9.583e-04	ex 10000	time 6.85s
train	ep 01700	it 000	loss 8.900e-04	ex 10000	time 6.89s
train	ep 01800	it 000	loss 8.264e-04	ex 10000	time 6.78s
train	ep 01900	it 000	loss 7.791e-04	ex 10000	time 6.85s
train	ep 02000	it 000	loss 7.352e-04	ex 10000	time 6.84s
train	ep 02100	it 000	loss 6.953e-04	ex 10000	time 6.79s
train	ep 02200	it 000	loss 6.631e-04	ex 10000	time 6.85s
train	ep 02300	it 000	loss 6.303e-04	ex 10000	time 6.86s
train	ep 02400	it 000	loss 6.074e-04	ex 10000	time 6.79s
train	ep 02500	it 000	loss 5.822e-04	ex 10000	time 6.87s
train	ep 02600	it 000	loss 5.645e-04	ex 10000	time 6.91s
train	ep 02700	it 000	loss 5.460e-04	ex 10000	time 6.84s
train	ep 02800	it 000	loss 5.300e-04	ex 10000	time 6.84s
train	ep 02900	it 000	loss 5.152e-04	ex 10000	time 6.87s
train	ep 03000	it 000	loss 5.016e-04	ex 10000	time 6.81s
train	ep 03100	it 000	loss 4.911e-04	ex 10000	time 6.86s
train	ep 03200	it 000	loss 4.753e-04	ex 10000	time 6.92s
train	ep 03300	it 000	loss 4.635e-04	ex 10000	time 6.82s
train	ep 03400	it 000	loss 4.507e-04	ex 10000	time 6.90s
train	ep 03500	it 000	loss 4.366e-04	ex 10000	time 6.88s
train	ep 03600	it 000	loss 4.238e-04	ex 10000	time 6.82s
train	ep 03700	it 000	loss 4.106e-04	ex 10000	time 6.87s
train	ep 03800	it 000	loss 3.962e-04	ex 10000	time 6.92s
train	ep 03900	it 000	loss 3.847e-04	ex 10000	time 6.82s
train	ep 04000	it 000	loss 3.729e-04	ex 10000	time 6.89s
train	ep 04100	it 000	loss 3.617e-04	ex 10000	time 6.92s
train	ep 04200	it 000	loss 3.517e-04	ex 10000	time 6.81s
train	ep 04300	it 000	loss 3.376e-04	ex 10000	time 6.89s
train	ep 04400	it 000	loss 3.206e-04	ex 10000	time 6.89s
train	ep 04500	it 000	loss 3.088e-04	ex 10000	time 6.80s
train	ep 04600	it 000	loss 2.746e-04	ex 10000	time 6.86s
train	ep 04700	it 000	loss 2.563e-04	ex 10000	time 6.87s
train	ep 04800	it 000	loss 2.436e-04	ex 10000	time 6.81s
train	ep 04900	it 000	loss 2.366e-04	ex 10000	time 6.88s
train	ep 05000	it 000	loss 2.283e-04	ex 10000	time 6.85s
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 1
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 18 of size bigger than 6.0.
removing 18/18 unaligned clusters
Collapsing 0 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':

Final layer size: 0
Traceback (most recent call last):
  File "/root/expand_and_cluster/EC.py", line 76, in <module>
    main()
  File "/root/expand_and_cluster/EC.py", line 72, in main
    platform.run_job(runner_registry.get(runner_name).create_from_args(args).run)
  File "/root/expand_and_cluster/platforms/base.py", line 130, in run_job
    f()
  File "/root/expand_and_cluster/extraction/runner.py", line 79, in run
    expand_and_cluster.reconstruct(students, losses, self.desc.extraction_path(self.global_seed),
  File "/root/expand_and_cluster/extraction/expand_and_cluster.py", line 175, in reconstruct
    w_rec = np.stack([w_rec]*N, axis=2)
  File "/opt/miniconda3/envs/ec_env/lib/python3.10/site-packages/numpy/core/shape_base.py", line 452, in stack
    axis = normalize_axis_index(axis, result_ndim)
numpy.exceptions.AxisError: axis 2 is out of bounds for array of dimension 2
