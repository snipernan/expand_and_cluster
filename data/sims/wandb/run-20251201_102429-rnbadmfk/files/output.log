Generating dataset with teacher...
train	ep 00000	it 000	loss 7.035e+00	ex 10000	time 0.00s
train	ep 00100	it 000	loss 6.419e-03	ex 10000	time 8.10s
train	ep 00200	it 000	loss 2.266e-03	ex 10000	time 8.37s
train	ep 00300	it 000	loss 8.983e-04	ex 10000	time 8.38s
train	ep 00400	it 000	loss 5.165e-04	ex 10000	time 8.48s
train	ep 00500	it 000	loss 3.988e-04	ex 10000	time 8.30s
train	ep 00600	it 000	loss 3.201e-04	ex 10000	time 7.45s
train	ep 00700	it 000	loss 2.746e-04	ex 10000	time 7.75s
train	ep 00800	it 000	loss 2.414e-04	ex 10000	time 7.69s
train	ep 00900	it 000	loss 2.084e-04	ex 10000	time 7.67s
train	ep 01000	it 000	loss 1.831e-04	ex 10000	time 7.97s
train	ep 01100	it 000	loss 1.737e-04	ex 10000	time 8.08s
train	ep 01200	it 000	loss 1.644e-04	ex 10000	time 8.03s
train	ep 01300	it 000	loss 1.670e-04	ex 10000	time 8.30s
train	ep 01400	it 000	loss 1.461e-04	ex 10000	time 8.37s
train	ep 01500	it 000	loss 1.425e-04	ex 10000	time 8.34s
train	ep 01600	it 000	loss 1.392e-04	ex 10000	time 8.40s
train	ep 01700	it 000	loss 1.262e-04	ex 10000	time 7.89s
train	ep 01800	it 000	loss 1.373e-04	ex 10000	time 7.85s
train	ep 01900	it 000	loss 1.269e-04	ex 10000	time 7.84s
train	ep 02000	it 000	loss 1.167e-04	ex 10000	time 7.97s
train	ep 02100	it 000	loss 1.071e-04	ex 10000	time 7.62s
train	ep 02200	it 000	loss 1.093e-04	ex 10000	time 7.72s
train	ep 02300	it 000	loss 9.465e-05	ex 10000	time 7.77s
train	ep 02400	it 000	loss 9.551e-05	ex 10000	time 7.50s
train	ep 02500	it 000	loss 9.570e-05	ex 10000	time 7.68s
train	ep 02600	it 000	loss 8.462e-05	ex 10000	time 7.45s
train	ep 02700	it 000	loss 7.756e-05	ex 10000	time 7.52s
train	ep 02800	it 000	loss 8.252e-05	ex 10000	time 7.58s
train	ep 02900	it 000	loss 7.660e-05	ex 10000	time 8.00s
train	ep 03000	it 000	loss 8.246e-05	ex 10000	time 7.58s
train	ep 03100	it 000	loss 8.499e-05	ex 10000	time 7.84s
train	ep 03200	it 000	loss 7.590e-05	ex 10000	time 7.73s
train	ep 03300	it 000	loss 7.364e-05	ex 10000	time 8.16s
train	ep 03400	it 000	loss 7.695e-05	ex 10000	time 7.76s
train	ep 03500	it 000	loss 7.201e-05	ex 10000	time 7.62s
train	ep 03600	it 000	loss 6.249e-05	ex 10000	time 7.79s
train	ep 03700	it 000	loss 6.024e-05	ex 10000	time 7.52s
train	ep 03800	it 000	loss 6.562e-05	ex 10000	time 7.68s
train	ep 03900	it 000	loss 6.575e-05	ex 10000	time 7.44s
train	ep 04000	it 000	loss 7.637e-05	ex 10000	time 8.17s
train	ep 04100	it 000	loss 6.045e-05	ex 10000	time 8.47s
train	ep 04200	it 000	loss 7.349e-05	ex 10000	time 8.58s
train	ep 04300	it 000	loss 5.791e-05	ex 10000	time 8.37s
train	ep 04400	it 000	loss 6.062e-05	ex 10000	time 8.61s
train	ep 04500	it 000	loss 5.263e-05	ex 10000	time 8.38s
train	ep 04600	it 000	loss 5.447e-05	ex 10000	time 8.72s
train	ep 04700	it 000	loss 5.913e-05	ex 10000	time 8.32s
train	ep 04800	it 000	loss 4.916e-05	ex 10000	time 8.63s
train	ep 04900	it 000	loss 5.159e-05	ex 10000	time 8.38s
train	ep 05000	it 000	loss 4.964e-05	ex 10000	time 8.40s
train	ep 05100	it 000	loss 7.886e-05	ex 10000	time 7.76s
train	ep 05200	it 000	loss 5.129e-05	ex 10000	time 7.63s
train	ep 05300	it 000	loss 5.453e-05	ex 10000	time 7.76s
train	ep 05400	it 000	loss 4.768e-05	ex 10000	time 7.75s
train	ep 05500	it 000	loss 4.579e-05	ex 10000	time 8.24s
train	ep 05600	it 000	loss 4.664e-05	ex 10000	time 8.32s
train	ep 05700	it 000	loss 5.855e-05	ex 10000	time 8.36s
train	ep 05800	it 000	loss 4.849e-05	ex 10000	time 8.30s
train	ep 05900	it 000	loss 5.874e-05	ex 10000	time 8.54s
train	ep 06000	it 000	loss 4.965e-05	ex 10000	time 8.55s
train	ep 06100	it 000	loss 5.377e-05	ex 10000	time 8.41s
train	ep 06200	it 000	loss 4.408e-05	ex 10000	time 8.17s
train	ep 06300	it 000	loss 4.630e-05	ex 10000	time 8.02s
train	ep 06400	it 000	loss 4.831e-05	ex 10000	time 8.04s
train	ep 06500	it 000	loss 5.217e-05	ex 10000	time 7.99s
train	ep 06600	it 000	loss 4.206e-05	ex 10000	time 7.50s
train	ep 06700	it 000	loss 5.089e-05	ex 10000	time 7.45s
train	ep 06800	it 000	loss 4.306e-05	ex 10000	time 7.58s
train	ep 06900	it 000	loss 4.359e-05	ex 10000	time 7.58s
train	ep 07000	it 000	loss 4.876e-05	ex 10000	time 7.63s
train	ep 07100	it 000	loss 3.956e-05	ex 10000	time 7.72s
train	ep 07200	it 000	loss 5.338e-05	ex 10000	time 7.50s
train	ep 07300	it 000	loss 4.149e-05	ex 10000	time 7.85s
train	ep 07400	it 000	loss 5.160e-05	ex 10000	time 7.89s
train	ep 07500	it 000	loss 4.815e-05	ex 10000	time 8.04s
train	ep 07600	it 000	loss 4.073e-05	ex 10000	time 7.75s
train	ep 07700	it 000	loss 5.130e-05	ex 10000	time 8.10s
train	ep 07800	it 000	loss 5.007e-05	ex 10000	time 7.75s
train	ep 07900	it 000	loss 4.672e-05	ex 10000	time 7.93s
train	ep 08000	it 000	loss 3.930e-05	ex 10000	time 7.76s
train	ep 08100	it 000	loss 4.152e-05	ex 10000	time 8.05s
train	ep 08200	it 000	loss 4.396e-05	ex 10000	time 7.83s
train	ep 08300	it 000	loss 4.628e-05	ex 10000	time 7.64s
train	ep 08400	it 000	loss 4.090e-05	ex 10000	time 7.72s
train	ep 08500	it 000	loss 4.357e-05	ex 10000	time 8.57s
train	ep 08600	it 000	loss 5.336e-05	ex 10000	time 8.58s
train	ep 08700	it 000	loss 5.024e-05	ex 10000	time 8.44s
train	ep 08800	it 000	loss 4.795e-05	ex 10000	time 8.55s
train	ep 08900	it 000	loss 4.146e-05	ex 10000	time 8.60s
train	ep 09000	it 000	loss 4.785e-05	ex 10000	time 8.79s
train	ep 09100	it 000	loss 4.410e-05	ex 10000	time 8.75s
train	ep 09200	it 000	loss 3.843e-05	ex 10000	time 8.60s
train	ep 09300	it 000	loss 3.695e-05	ex 10000	time 8.58s
train	ep 09400	it 000	loss 4.571e-05	ex 10000	time 8.53s
train	ep 09500	it 000	loss 4.244e-05	ex 10000	time 8.26s
train	ep 09600	it 000	loss 4.834e-05	ex 10000	time 7.69s
train	ep 09700	it 000	loss 3.661e-05	ex 10000	time 7.67s
train	ep 09800	it 000	loss 4.320e-05	ex 10000	time 7.73s
train	ep 09900	it 000	loss 4.080e-05	ex 10000	time 8.17s
train	ep 10000	it 000	loss 3.878e-05	ex 10000	time 8.44s
============================================================================================================================================
Reconstruction
--------------------------------------------------------------------------------------------------------------------------------------------
Reconstruction Location: /home/alvin/expand-and-cluster/data/sims/ec_6c987cb398/seed_-1/main/clustering_a48fe7727a
--------------------------------------------------------------------------------------------------------------------------------------------

Generating dataset with teacher...
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 0
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 10 of size bigger than 4.0.
removing 0/10 unaligned clusters
Collapsing 10 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':
#0->1, #1->1, #2->1, #3->5, #4->2, #5->1, #6->1, #7->1, #8->1, #9->3,
Final layer size: 10

train	ep 00000	it 000	loss 9.718e+00	ex 10000	time 0.00s
train	ep 00100	it 000	loss 2.234e-01	ex 10000	time 8.92s
train	ep 00200	it 000	loss 4.998e-02	ex 10000	time 8.62s
train	ep 00300	it 000	loss 2.337e-02	ex 10000	time 8.75s
train	ep 00400	it 000	loss 1.245e-02	ex 10000	time 8.77s
train	ep 00500	it 000	loss 7.341e-03	ex 10000	time 8.88s
train	ep 00600	it 000	loss 4.521e-03	ex 10000	time 8.34s
train	ep 00700	it 000	loss 2.917e-03	ex 10000	time 7.58s
train	ep 00800	it 000	loss 2.177e-03	ex 10000	time 9.33s
train	ep 00900	it 000	loss 1.789e-03	ex 10000	time 8.87s
train	ep 01000	it 000	loss 1.552e-03	ex 10000	time 8.73s
train	ep 01100	it 000	loss 1.373e-03	ex 10000	time 9.21s
train	ep 01200	it 000	loss 1.235e-03	ex 10000	time 8.83s
train	ep 01300	it 000	loss 1.100e-03	ex 10000	time 8.60s
train	ep 01400	it 000	loss 9.987e-04	ex 10000	time 8.56s
train	ep 01500	it 000	loss 9.404e-04	ex 10000	time 8.86s
train	ep 01600	it 000	loss 8.868e-04	ex 10000	time 8.75s
train	ep 01700	it 000	loss 8.448e-04	ex 10000	time 8.56s
train	ep 01800	it 000	loss 8.117e-04	ex 10000	time 8.79s
train	ep 01900	it 000	loss 7.830e-04	ex 10000	time 8.66s
train	ep 02000	it 000	loss 7.591e-04	ex 10000	time 8.93s
train	ep 02100	it 000	loss 7.334e-04	ex 10000	time 8.75s
train	ep 02200	it 000	loss 7.071e-04	ex 10000	time 8.84s
train	ep 02300	it 000	loss 6.838e-04	ex 10000	time 8.83s
train	ep 02400	it 000	loss 6.590e-04	ex 10000	time 8.89s
train	ep 02500	it 000	loss 6.375e-04	ex 10000	time 8.65s
train	ep 02600	it 000	loss 6.218e-04	ex 10000	time 9.16s
train	ep 02700	it 000	loss 5.998e-04	ex 10000	time 9.79s
train	ep 02800	it 000	loss 5.817e-04	ex 10000	time 9.46s
train	ep 02900	it 000	loss 5.668e-04	ex 10000	time 9.65s
train	ep 03000	it 000	loss 5.508e-04	ex 10000	time 9.74s
train	ep 03100	it 000	loss 5.371e-04	ex 10000	time 9.78s
train	ep 03200	it 000	loss 5.244e-04	ex 10000	time 9.39s
train	ep 03300	it 000	loss 5.097e-04	ex 10000	time 9.65s
train	ep 03400	it 000	loss 5.013e-04	ex 10000	time 9.67s
train	ep 03500	it 000	loss 4.877e-04	ex 10000	time 9.18s
train	ep 03600	it 000	loss 4.800e-04	ex 10000	time 8.91s
train	ep 03700	it 000	loss 4.721e-04	ex 10000	time 8.64s
train	ep 03800	it 000	loss 4.673e-04	ex 10000	time 8.77s
train	ep 03900	it 000	loss 4.610e-04	ex 10000	time 9.40s
train	ep 04000	it 000	loss 4.558e-04	ex 10000	time 9.55s
train	ep 04100	it 000	loss 4.500e-04	ex 10000	time 9.57s
train	ep 04200	it 000	loss 4.450e-04	ex 10000	time 8.58s
train	ep 04300	it 000	loss 4.404e-04	ex 10000	time 8.79s
train	ep 04400	it 000	loss 4.362e-04	ex 10000	time 8.72s
train	ep 04500	it 000	loss 4.340e-04	ex 10000	time 8.89s
train	ep 04600	it 000	loss 4.310e-04	ex 10000	time 8.31s
train	ep 04700	it 000	loss 4.258e-04	ex 10000	time 8.41s
train	ep 04800	it 000	loss 4.236e-04	ex 10000	time 8.31s
train	ep 04900	it 000	loss 4.200e-04	ex 10000	time 8.12s
train	ep 05000	it 000	loss 4.172e-04	ex 10000	time 8.03s
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 1
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 18 of size bigger than 4.0.
removing 18/18 unaligned clusters
Collapsing 0 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':

Final layer size: 0
Traceback (most recent call last):
  File "/home/alvin/expand-and-cluster/EC.py", line 76, in <module>
    main()
  File "/home/alvin/expand-and-cluster/EC.py", line 72, in main
    platform.run_job(runner_registry.get(runner_name).create_from_args(args).run)
  File "/home/alvin/expand-and-cluster/platforms/base.py", line 130, in run_job
    f()
  File "/home/alvin/expand-and-cluster/extraction/runner.py", line 79, in run
    expand_and_cluster.reconstruct(students, losses, self.desc.extraction_path(self.global_seed),
  File "/home/alvin/expand-and-cluster/extraction/expand_and_cluster.py", line 175, in reconstruct
    w_rec = np.stack([w_rec]*N, axis=2)
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/numpy/core/shape_base.py", line 452, in stack
    axis = normalize_axis_index(axis, result_ndim)
numpy.exceptions.AxisError: axis 2 is out of bounds for array of dimension 2
