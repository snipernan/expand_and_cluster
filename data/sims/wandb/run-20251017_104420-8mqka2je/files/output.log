Generating dataset with teacher...
============================================================================================================================================
Reconstruction
--------------------------------------------------------------------------------------------------------------------------------------------
Reconstruction Location: /home/alvin/expand-and-cluster/data/sims/ec_a04c4aed4b/seed_-1/main/clustering_f0d6804a48
--------------------------------------------------------------------------------------------------------------------------------------------

Generating dataset with teacher...
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 0
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 31 of size bigger than 10.0.
removing 11/31 unaligned clusters
Collapsing 20 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':
#0->1, #1->1, #2->1, #3->1, #4->1, #5->1, #6->1, #7->1, #8->1, #9->1, #10->1, #11->1, #12->1, #13->1, #14->1, #15->1, #16->1, #17->1, #18->1, #19->1,
Final layer size: 20

train	ep 00000	it 000	loss 3.217e+03	ex 60000	time 0.00s
train	ep 00100	it 000	loss 1.598e+02	ex 60000	time 94.87s
train	ep 00200	it 000	loss 1.244e+02	ex 60000	time 97.29s
train	ep 00300	it 000	loss 1.099e+02	ex 60000	time 94.20s
train	ep 00400	it 000	loss 1.009e+02	ex 60000	time 90.48s
train	ep 00500	it 000	loss 9.463e+01	ex 60000	time 93.69s
train	ep 00600	it 000	loss 8.959e+01	ex 60000	time 97.53s
train	ep 00700	it 000	loss 8.567e+01	ex 60000	time 89.88s
train	ep 00800	it 000	loss 8.226e+01	ex 60000	time 94.31s
train	ep 00900	it 000	loss 7.944e+01	ex 60000	time 94.22s
train	ep 01000	it 000	loss 7.678e+01	ex 60000	time 89.92s
train	ep 01100	it 000	loss 7.438e+01	ex 60000	time 92.26s
Traceback (most recent call last):
  File "/home/alvin/expand-and-cluster/EC.py", line 76, in <module>
    main()
  File "/home/alvin/expand-and-cluster/EC.py", line 72, in main
    platform.run_job(runner_registry.get(runner_name).create_from_args(args).run)
  File "/home/alvin/expand-and-cluster/platforms/base.py", line 130, in run_job
    f()
  File "/home/alvin/expand-and-cluster/extraction/runner.py", line 79, in run
    expand_and_cluster.reconstruct(students, losses, self.desc.extraction_path(self.global_seed),
  File "/home/alvin/expand-and-cluster/extraction/expand_and_cluster.py", line 191, in reconstruct
    train(finetune_hparams, students, train_loader,
  File "/home/alvin/expand-and-cluster/training/train.py", line 126, in train
    for it, (examples, labels) in enumerate(train_loader):
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 679, in _next_data
    data = _utils.pin_memory.pin_memory(data, self._pin_memory_device)
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/torch/utils/data/_utils/pin_memory.py", line 70, in pin_memory
    return type(data)([pin_memory(sample, device) for sample in data])  # type: ignore[call-arg]
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/torch/utils/data/_utils/pin_memory.py", line 70, in <listcomp>
    return type(data)([pin_memory(sample, device) for sample in data])  # type: ignore[call-arg]
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/torch/utils/data/_utils/pin_memory.py", line 55, in pin_memory
    return data.pin_memory(device)
KeyboardInterrupt
