Generating dataset with teacher...
Ep 1300	It 0	Time Elapsed 0.00
Ep 1400	It 0	Time Elapsed 79.48
Ep 1500	It 0	Time Elapsed 80.66
Ep 1600	It 0	Time Elapsed 82.04
Ep 1700	It 0	Time Elapsed 81.56
Ep 1800	It 0	Time Elapsed 80.55
Ep 1900	It 0	Time Elapsed 84.56
Ep 2000	It 0	Time Elapsed 83.22
Ep 2100	It 0	Time Elapsed 85.40
Ep 2200	It 0	Time Elapsed 85.59
Ep 2300	It 0	Time Elapsed 86.38
Ep 2400	It 0	Time Elapsed 86.33
Ep 2500	It 0	Time Elapsed 87.74
Ep 2600	It 0	Time Elapsed 87.89
Ep 2700	It 0	Time Elapsed 86.59
Ep 2800	It 0	Time Elapsed 86.06
Ep 2900	It 0	Time Elapsed 83.71
Ep 3000	It 0	Time Elapsed 83.97
Ep 3100	It 0	Time Elapsed 83.38
Ep 3200	It 0	Time Elapsed 83.92
Ep 3300	It 0	Time Elapsed 83.36
Ep 3400	It 0	Time Elapsed 84.25
Ep 3500	It 0	Time Elapsed 84.34
Ep 3600	It 0	Time Elapsed 85.34
Ep 3700	It 0	Time Elapsed 83.36
Ep 3800	It 0	Time Elapsed 85.30
Ep 3900	It 0	Time Elapsed 84.23
Ep 4000	It 0	Time Elapsed 84.87
Ep 4100	It 0	Time Elapsed 84.33
Ep 4200	It 0	Time Elapsed 84.88
Ep 4300	It 0	Time Elapsed 82.75
Ep 4400	It 0	Time Elapsed 84.59
Ep 4500	It 0	Time Elapsed 82.61
Ep 4600	It 0	Time Elapsed 84.67
Ep 4700	It 0	Time Elapsed 84.21
Ep 4800	It 0	Time Elapsed 84.64
Ep 4900	It 0	Time Elapsed 83.05
Ep 5000	It 0	Time Elapsed 84.56
Ep 5100	It 0	Time Elapsed 83.57
Ep 5200	It 0	Time Elapsed 84.84
Ep 5300	It 0	Time Elapsed 83.86
Ep 5400	It 0	Time Elapsed 84.94
Ep 5500	It 0	Time Elapsed 83.89
Ep 5600	It 0	Time Elapsed 85.21
Ep 5700	It 0	Time Elapsed 83.44
Ep 5800	It 0	Time Elapsed 85.46
Ep 5900	It 0	Time Elapsed 83.43
Ep 6000	It 0	Time Elapsed 84.24
Ep 6100	It 0	Time Elapsed 83.38
Ep 6200	It 0	Time Elapsed 84.89
Ep 6300	It 0	Time Elapsed 84.36
Ep 6400	It 0	Time Elapsed 84.04
Ep 6500	It 0	Time Elapsed 84.57
Ep 6600	It 0	Time Elapsed 83.94
Ep 6700	It 0	Time Elapsed 84.93
Ep 6800	It 0	Time Elapsed 83.91
Ep 6900	It 0	Time Elapsed 85.03
Ep 7000	It 0	Time Elapsed 83.24
Ep 7100	It 0	Time Elapsed 83.99
Ep 7200	It 0	Time Elapsed 83.21
Ep 7300	It 0	Time Elapsed 84.10
Ep 7400	It 0	Time Elapsed 83.53
Ep 7500	It 0	Time Elapsed 85.25
Ep 7600	It 0	Time Elapsed 83.52
Ep 7700	It 0	Time Elapsed 84.47
Ep 7800	It 0	Time Elapsed 84.36
Ep 7900	It 0	Time Elapsed 84.20
Ep 8000	It 0	Time Elapsed 83.09
Ep 8100	It 0	Time Elapsed 84.81
Ep 8200	It 0	Time Elapsed 83.48
Ep 8300	It 0	Time Elapsed 84.86
Ep 8400	It 0	Time Elapsed 84.06
Ep 8500	It 0	Time Elapsed 84.99
Ep 8600	It 0	Time Elapsed 83.86
Ep 8700	It 0	Time Elapsed 84.85
Ep 8800	It 0	Time Elapsed 82.85
Ep 8900	It 0	Time Elapsed 84.44
Ep 9000	It 0	Time Elapsed 84.46
Ep 9100	It 0	Time Elapsed 84.38
Ep 9200	It 0	Time Elapsed 84.03
Ep 9300	It 0	Time Elapsed 84.76
Ep 9400	It 0	Time Elapsed 84.08
Ep 9500	It 0	Time Elapsed 85.25
Ep 9600	It 0	Time Elapsed 83.64
Ep 9700	It 0	Time Elapsed 84.91
Ep 9800	It 0	Time Elapsed 84.07
Ep 9900	It 0	Time Elapsed 85.21
Ep 10000	It 0	Time Elapsed 83.37
Ep 10100	It 0	Time Elapsed 84.38
Ep 10200	It 0	Time Elapsed 83.14
Ep 10300	It 0	Time Elapsed 82.76
Ep 10400	It 0	Time Elapsed 84.53
Ep 10500	It 0	Time Elapsed 83.52
Ep 10600	It 0	Time Elapsed 84.79
Ep 10700	It 0	Time Elapsed 83.30
Ep 10800	It 0	Time Elapsed 84.81
Ep 10900	It 0	Time Elapsed 83.12
Ep 11000	It 0	Time Elapsed 84.60
Ep 11100	It 0	Time Elapsed 83.37
Ep 11200	It 0	Time Elapsed 84.54
Ep 11300	It 0	Time Elapsed 83.90
Ep 11400	It 0	Time Elapsed 85.24
Ep 11500	It 0	Time Elapsed 83.65
Ep 11600	It 0	Time Elapsed 85.26
Ep 11700	It 0	Time Elapsed 82.90
Ep 11800	It 0	Time Elapsed 84.78
Ep 11900	It 0	Time Elapsed 83.01
Ep 12000	It 0	Time Elapsed 84.68
Ep 12100	It 0	Time Elapsed 83.19
Ep 12200	It 0	Time Elapsed 85.25
Ep 12300	It 0	Time Elapsed 83.26
Ep 12400	It 0	Time Elapsed 85.14
Ep 12500	It 0	Time Elapsed 83.13
Ep 12600	It 0	Time Elapsed 85.22
Ep 12700	It 0	Time Elapsed 83.90
Ep 12800	It 0	Time Elapsed 84.41
Ep 12900	It 0	Time Elapsed 83.04
Ep 13000	It 0	Time Elapsed 84.32
Ep 13100	It 0	Time Elapsed 83.34
Ep 13200	It 0	Time Elapsed 84.91
Ep 13300	It 0	Time Elapsed 83.17
Ep 13400	It 0	Time Elapsed 84.41
Ep 13500	It 0	Time Elapsed 84.36
Ep 13600	It 0	Time Elapsed 84.35
Ep 13700	It 0	Time Elapsed 83.12
Ep 13800	It 0	Time Elapsed 84.66
Ep 13900	It 0	Time Elapsed 83.69
Ep 14000	It 0	Time Elapsed 83.53
Ep 14100	It 0	Time Elapsed 85.65
Ep 14200	It 0	Time Elapsed 83.83
Ep 14300	It 0	Time Elapsed 84.29
Ep 14400	It 0	Time Elapsed 83.01
Ep 14500	It 0	Time Elapsed 84.34
Ep 14600	It 0	Time Elapsed 83.16
Ep 14700	It 0	Time Elapsed 84.56
Ep 14800	It 0	Time Elapsed 83.93
Ep 14900	It 0	Time Elapsed 84.90
Ep 15000	It 0	Time Elapsed 83.99
Ep 15100	It 0	Time Elapsed 84.57
Ep 15200	It 0	Time Elapsed 84.21
Ep 15300	It 0	Time Elapsed 84.61
Ep 15400	It 0	Time Elapsed 83.15
Ep 15500	It 0	Time Elapsed 84.32
Ep 15600	It 0	Time Elapsed 84.04
Ep 15700	It 0	Time Elapsed 84.65
Ep 15800	It 0	Time Elapsed 82.78
Ep 15900	It 0	Time Elapsed 84.30
Ep 16000	It 0	Time Elapsed 82.86
Ep 16100	It 0	Time Elapsed 84.57
Ep 16200	It 0	Time Elapsed 83.25
Ep 16300	It 0	Time Elapsed 85.35
Ep 16400	It 0	Time Elapsed 83.50
Ep 16500	It 0	Time Elapsed 82.91
Ep 16600	It 0	Time Elapsed 84.65
Ep 16700	It 0	Time Elapsed 83.86
Ep 16800	It 0	Time Elapsed 84.58
Ep 16900	It 0	Time Elapsed 82.66
Ep 17000	It 0	Time Elapsed 85.05
Ep 17100	It 0	Time Elapsed 84.21
Ep 17200	It 0	Time Elapsed 84.94
Ep 17300	It 0	Time Elapsed 82.96
Ep 17400	It 0	Time Elapsed 84.77
Ep 17500	It 0	Time Elapsed 83.63
Ep 17600	It 0	Time Elapsed 85.38
Ep 17700	It 0	Time Elapsed 83.17
Ep 17800	It 0	Time Elapsed 86.03
Ep 17900	It 0	Time Elapsed 83.33
Ep 18000	It 0	Time Elapsed 84.71
Ep 18100	It 0	Time Elapsed 83.34
Ep 18200	It 0	Time Elapsed 85.26
Ep 18300	It 0	Time Elapsed 83.65
Ep 18400	It 0	Time Elapsed 85.72
Ep 18500	It 0	Time Elapsed 83.73
Ep 18600	It 0	Time Elapsed 85.25
Ep 18700	It 0	Time Elapsed 83.15
Ep 18800	It 0	Time Elapsed 85.06
Ep 18900	It 0	Time Elapsed 84.22
Ep 19000	It 0	Time Elapsed 83.01
Ep 19100	It 0	Time Elapsed 91.53
Ep 19200	It 0	Time Elapsed 89.34
Ep 19300	It 0	Time Elapsed 89.22
Ep 19400	It 0	Time Elapsed 88.91
Ep 19500	It 0	Time Elapsed 87.09
Ep 19600	It 0	Time Elapsed 93.58
Ep 19700	It 0	Time Elapsed 95.54
Ep 19800	It 0	Time Elapsed 93.82
Ep 19900	It 0	Time Elapsed 89.47
Ep 20000	It 0	Time Elapsed 85.72
Ep 20100	It 0	Time Elapsed 84.24
Ep 20200	It 0	Time Elapsed 86.13
Ep 20300	It 0	Time Elapsed 84.67
Ep 20400	It 0	Time Elapsed 86.50
Ep 20500	It 0	Time Elapsed 85.26
Ep 20600	It 0	Time Elapsed 86.53
Ep 20700	It 0	Time Elapsed 83.48
Ep 20800	It 0	Time Elapsed 86.17
Ep 20900	It 0	Time Elapsed 84.62
Ep 21000	It 0	Time Elapsed 86.05
Ep 21100	It 0	Time Elapsed 85.48
Ep 21200	It 0	Time Elapsed 86.03
Ep 21300	It 0	Time Elapsed 84.52
Ep 21400	It 0	Time Elapsed 85.66
Ep 21500	It 0	Time Elapsed 84.14
Ep 21600	It 0	Time Elapsed 85.84
Ep 21700	It 0	Time Elapsed 84.90
Ep 21800	It 0	Time Elapsed 85.98
Ep 21900	It 0	Time Elapsed 83.72
Ep 22000	It 0	Time Elapsed 85.51
Ep 22100	It 0	Time Elapsed 83.71
Ep 22200	It 0	Time Elapsed 85.66
Ep 22300	It 0	Time Elapsed 83.87
Ep 22400	It 0	Time Elapsed 85.08
Ep 22500	It 0	Time Elapsed 83.89
Ep 22600	It 0	Time Elapsed 85.59
Ep 22700	It 0	Time Elapsed 84.18
Ep 22800	It 0	Time Elapsed 86.55
Ep 22900	It 0	Time Elapsed 83.58
Ep 23000	It 0	Time Elapsed 85.32
Ep 23100	It 0	Time Elapsed 83.61
Ep 23200	It 0	Time Elapsed 85.67
Ep 23300	It 0	Time Elapsed 83.93
Ep 23400	It 0	Time Elapsed 85.75
Ep 23500	It 0	Time Elapsed 83.93
Ep 23600	It 0	Time Elapsed 86.14
Ep 23700	It 0	Time Elapsed 86.45
Ep 23800	It 0	Time Elapsed 85.99
Ep 23900	It 0	Time Elapsed 84.33
Ep 24000	It 0	Time Elapsed 86.46
Ep 24100	It 0	Time Elapsed 84.89
Ep 24200	It 0	Time Elapsed 85.40
Ep 24300	It 0	Time Elapsed 85.96
Ep 24400	It 0	Time Elapsed 83.96
Ep 24500	It 0	Time Elapsed 86.44
Ep 24600	It 0	Time Elapsed 84.22
Ep 24700	It 0	Time Elapsed 85.37
Ep 24800	It 0	Time Elapsed 84.77
Ep 24900	It 0	Time Elapsed 85.82
train	ep 25000	it 000	loss 2.664e-03	ex 60000	time 0.00s
Ep 25000	It 0	Time Elapsed 86.32
============================================================================================================================================
Reconstruction
--------------------------------------------------------------------------------------------------------------------------------------------
Reconstruction Location: /home/alvin/expand-and-cluster/data/sims/ec_fc608b8f2e/seed_-1/main/clustering_31924a37bd
--------------------------------------------------------------------------------------------------------------------------------------------

Generating dataset with teacher...
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 0
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 23 of size bigger than 8.0.
removing 3/23 unaligned clusters
Collapsing 20 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':
#0->1, #1->1, #2->1, #3->1, #4->1, #5->1, #6->1, #7->1, #8->1, #9->1, #10->1, #11->1, #12->1, #13->1, #14->1, #15->1, #16->1, #17->1, #18->1, #19->1,
Final layer size: 20

train	ep 00000	it 000	loss 2.118e+03	ex 60000	time 0.00s
train	ep 00100	it 000	loss 8.866e+01	ex 60000	time 61.13s
train	ep 00200	it 000	loss 6.991e+01	ex 60000	time 60.08s
train	ep 00300	it 000	loss 6.157e+01	ex 60000	time 61.23s
train	ep 00400	it 000	loss 5.585e+01	ex 60000	time 61.07s
train	ep 00500	it 000	loss 5.231e+01	ex 60000	time 61.81s
train	ep 00600	it 000	loss 4.976e+01	ex 60000	time 62.59s
train	ep 00700	it 000	loss 4.781e+01	ex 60000	time 62.11s
train	ep 00800	it 000	loss 4.628e+01	ex 60000	time 61.44s
train	ep 00900	it 000	loss 4.492e+01	ex 60000	time 61.56s
train	ep 01000	it 000	loss 4.368e+01	ex 60000	time 62.99s
train	ep 01100	it 000	loss 4.266e+01	ex 60000	time 63.14s
train	ep 01200	it 000	loss 4.167e+01	ex 60000	time 63.09s
train	ep 01300	it 000	loss 4.082e+01	ex 60000	time 63.37s
train	ep 01400	it 000	loss 3.992e+01	ex 60000	time 61.14s
train	ep 01500	it 000	loss 3.911e+01	ex 60000	time 62.04s
train	ep 01600	it 000	loss 3.834e+01	ex 60000	time 61.31s
train	ep 01700	it 000	loss 3.762e+01	ex 60000	time 61.70s
train	ep 01800	it 000	loss 3.691e+01	ex 60000	time 61.43s
train	ep 01900	it 000	loss 3.623e+01	ex 60000	time 59.60s
train	ep 02000	it 000	loss 3.555e+01	ex 60000	time 61.60s
train	ep 02100	it 000	loss 3.495e+01	ex 60000	time 61.49s
train	ep 02200	it 000	loss 3.449e+01	ex 60000	time 61.69s
train	ep 02300	it 000	loss 3.401e+01	ex 60000	time 60.29s
train	ep 02400	it 000	loss 3.358e+01	ex 60000	time 62.67s
train	ep 02500	it 000	loss 3.325e+01	ex 60000	time 63.92s
train	ep 02600	it 000	loss 3.289e+01	ex 60000	time 62.49s
train	ep 02700	it 000	loss 3.255e+01	ex 60000	time 62.42s
train	ep 02800	it 000	loss 3.219e+01	ex 60000	time 62.58s
train	ep 02900	it 000	loss 3.187e+01	ex 60000	time 61.13s
train	ep 03000	it 000	loss 3.150e+01	ex 60000	time 62.35s
train	ep 03100	it 000	loss 3.122e+01	ex 60000	time 61.52s
train	ep 03200	it 000	loss 3.098e+01	ex 60000	time 61.85s
train	ep 03300	it 000	loss 3.069e+01	ex 60000	time 61.84s
train	ep 03400	it 000	loss 3.045e+01	ex 60000	time 62.98s
train	ep 03500	it 000	loss 3.017e+01	ex 60000	time 61.03s
train	ep 03600	it 000	loss 2.995e+01	ex 60000	time 63.39s
train	ep 03700	it 000	loss 2.971e+01	ex 60000	time 63.59s
train	ep 03800	it 000	loss 2.951e+01	ex 60000	time 62.72s
train	ep 03900	it 000	loss 2.924e+01	ex 60000	time 63.65s
train	ep 04000	it 000	loss 2.905e+01	ex 60000	time 62.33s
train	ep 04100	it 000	loss 2.892e+01	ex 60000	time 59.94s
train	ep 04200	it 000	loss 2.870e+01	ex 60000	time 60.93s
train	ep 04300	it 000	loss 2.853e+01	ex 60000	time 61.79s
train	ep 04400	it 000	loss 2.839e+01	ex 60000	time 62.53s
train	ep 04500	it 000	loss 2.828e+01	ex 60000	time 62.85s
train	ep 04600	it 000	loss 2.816e+01	ex 60000	time 61.26s
train	ep 04700	it 000	loss 2.799e+01	ex 60000	time 62.89s
train	ep 04800	it 000	loss 2.788e+01	ex 60000	time 63.43s
train	ep 04900	it 000	loss 2.774e+01	ex 60000	time 62.26s
train	ep 05000	it 000	loss 2.763e+01	ex 60000	time 62.70s
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 1
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 32 of size bigger than 8.0.
removing 32/32 unaligned clusters
Collapsing 0 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':

Final layer size: 0
Traceback (most recent call last):
  File "/home/alvin/expand-and-cluster/EC.py", line 76, in <module>
    main()
  File "/home/alvin/expand-and-cluster/EC.py", line 72, in main
    platform.run_job(runner_registry.get(runner_name).create_from_args(args).run)
  File "/home/alvin/expand-and-cluster/platforms/base.py", line 130, in run_job
    f()
  File "/home/alvin/expand-and-cluster/extraction/runner.py", line 79, in run
    expand_and_cluster.reconstruct(students, losses, self.desc.extraction_path(self.global_seed),
  File "/home/alvin/expand-and-cluster/extraction/expand_and_cluster.py", line 175, in reconstruct
    w_rec = np.stack([w_rec]*N, axis=2)
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/numpy/core/shape_base.py", line 452, in stack
    axis = normalize_axis_index(axis, result_ndim)
numpy.exceptions.AxisError: axis 2 is out of bounds for array of dimension 2
