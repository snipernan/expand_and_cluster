Generating dataset with teacher...
Ep 400	It 0	Time Elapsed 0.00
Ep 500	It 0	Time Elapsed 141.39
Ep 600	It 0	Time Elapsed 139.10
Ep 700	It 0	Time Elapsed 139.88
Ep 800	It 0	Time Elapsed 144.67
Ep 900	It 0	Time Elapsed 144.14
Ep 1000	It 0	Time Elapsed 136.69
Ep 1100	It 0	Time Elapsed 137.32
Ep 1200	It 0	Time Elapsed 137.06
Ep 1300	It 0	Time Elapsed 137.69
Ep 1400	It 0	Time Elapsed 137.52
Ep 1500	It 0	Time Elapsed 137.58
Ep 1600	It 0	Time Elapsed 137.49
Ep 1700	It 0	Time Elapsed 137.79
Ep 1800	It 0	Time Elapsed 137.46
Ep 1900	It 0	Time Elapsed 137.89
Ep 2000	It 0	Time Elapsed 137.30
Ep 2100	It 0	Time Elapsed 136.88
Ep 2200	It 0	Time Elapsed 136.90
Ep 2300	It 0	Time Elapsed 135.65
Ep 2400	It 0	Time Elapsed 137.14
Ep 2500	It 0	Time Elapsed 136.82
Ep 2600	It 0	Time Elapsed 136.92
Ep 2700	It 0	Time Elapsed 137.23
Ep 2800	It 0	Time Elapsed 138.28
Ep 2900	It 0	Time Elapsed 137.82
Ep 3000	It 0	Time Elapsed 137.96
Ep 3100	It 0	Time Elapsed 137.99
Ep 3200	It 0	Time Elapsed 138.07
Ep 3300	It 0	Time Elapsed 137.77
Ep 3400	It 0	Time Elapsed 137.34
Ep 3500	It 0	Time Elapsed 137.97
Ep 3600	It 0	Time Elapsed 137.70
Ep 3700	It 0	Time Elapsed 137.45
Ep 3800	It 0	Time Elapsed 137.12
Ep 3900	It 0	Time Elapsed 137.05
Ep 4000	It 0	Time Elapsed 134.75
Ep 4100	It 0	Time Elapsed 137.78
Ep 4200	It 0	Time Elapsed 137.21
Ep 4300	It 0	Time Elapsed 136.81
Ep 4400	It 0	Time Elapsed 136.80
Ep 4500	It 0	Time Elapsed 137.48
Ep 4600	It 0	Time Elapsed 136.65
Ep 4700	It 0	Time Elapsed 136.89
Ep 4800	It 0	Time Elapsed 138.10
Ep 4900	It 0	Time Elapsed 137.30
Ep 5000	It 0	Time Elapsed 137.80
Ep 5100	It 0	Time Elapsed 138.02
Ep 5200	It 0	Time Elapsed 136.90
Ep 5300	It 0	Time Elapsed 137.58
Ep 5400	It 0	Time Elapsed 137.40
Ep 5500	It 0	Time Elapsed 137.24
Ep 5600	It 0	Time Elapsed 137.70
Ep 5700	It 0	Time Elapsed 137.76
Ep 5800	It 0	Time Elapsed 137.73
Ep 5900	It 0	Time Elapsed 137.85
Ep 6000	It 0	Time Elapsed 137.32
Ep 6100	It 0	Time Elapsed 138.25
Ep 6200	It 0	Time Elapsed 137.38
Ep 6300	It 0	Time Elapsed 137.17
Ep 6400	It 0	Time Elapsed 137.11
Ep 6500	It 0	Time Elapsed 137.04
Ep 6600	It 0	Time Elapsed 137.28
Ep 6700	It 0	Time Elapsed 137.14
Ep 6800	It 0	Time Elapsed 137.28
Ep 6900	It 0	Time Elapsed 135.33
Ep 7000	It 0	Time Elapsed 138.81
Ep 7100	It 0	Time Elapsed 138.15
Ep 7200	It 0	Time Elapsed 136.83
Ep 7300	It 0	Time Elapsed 136.99
Ep 7400	It 0	Time Elapsed 136.89
Ep 7500	It 0	Time Elapsed 136.96
Ep 7600	It 0	Time Elapsed 137.74
Ep 7700	It 0	Time Elapsed 136.76
Ep 7800	It 0	Time Elapsed 137.51
Ep 7900	It 0	Time Elapsed 137.21
Ep 8000	It 0	Time Elapsed 137.95
Ep 8100	It 0	Time Elapsed 137.66
Ep 8200	It 0	Time Elapsed 137.80
Ep 8300	It 0	Time Elapsed 138.01
Ep 8400	It 0	Time Elapsed 137.58
Ep 8500	It 0	Time Elapsed 137.01
Ep 8600	It 0	Time Elapsed 138.06
Ep 8700	It 0	Time Elapsed 137.66
Ep 8800	It 0	Time Elapsed 137.31
Ep 8900	It 0	Time Elapsed 137.26
Ep 9000	It 0	Time Elapsed 137.54
Ep 9100	It 0	Time Elapsed 137.46
Ep 9200	It 0	Time Elapsed 137.93
Ep 9300	It 0	Time Elapsed 137.30
Ep 9400	It 0	Time Elapsed 137.45
Ep 9500	It 0	Time Elapsed 137.85
Ep 9600	It 0	Time Elapsed 137.84
Ep 9700	It 0	Time Elapsed 138.15
Ep 9800	It 0	Time Elapsed 138.21
Ep 9900	It 0	Time Elapsed 137.06
Ep 10000	It 0	Time Elapsed 137.94
Ep 10100	It 0	Time Elapsed 137.90
Ep 10200	It 0	Time Elapsed 137.68
Ep 10300	It 0	Time Elapsed 137.06
Ep 10400	It 0	Time Elapsed 137.09
Ep 10500	It 0	Time Elapsed 134.63
Ep 10600	It 0	Time Elapsed 137.08
Ep 10700	It 0	Time Elapsed 136.79
Ep 10800	It 0	Time Elapsed 138.35
Ep 10900	It 0	Time Elapsed 137.87
Ep 11000	It 0	Time Elapsed 137.91
Ep 11100	It 0	Time Elapsed 138.17
Ep 11200	It 0	Time Elapsed 137.84
Ep 11300	It 0	Time Elapsed 137.52
Ep 11400	It 0	Time Elapsed 139.34
Ep 11500	It 0	Time Elapsed 137.44
Ep 11600	It 0	Time Elapsed 137.93
Ep 11700	It 0	Time Elapsed 137.36
Ep 11800	It 0	Time Elapsed 137.49
Ep 11900	It 0	Time Elapsed 136.96
Ep 12000	It 0	Time Elapsed 136.99
Ep 12100	It 0	Time Elapsed 137.61
Ep 12200	It 0	Time Elapsed 134.45
Ep 12300	It 0	Time Elapsed 137.39
Ep 12400	It 0	Time Elapsed 138.59
Ep 12500	It 0	Time Elapsed 137.42
Ep 12600	It 0	Time Elapsed 137.90
Ep 12700	It 0	Time Elapsed 137.92
Ep 12800	It 0	Time Elapsed 138.16
Ep 12900	It 0	Time Elapsed 137.63
Ep 13000	It 0	Time Elapsed 137.94
Ep 13100	It 0	Time Elapsed 137.18
Ep 13200	It 0	Time Elapsed 137.63
Ep 13300	It 0	Time Elapsed 137.84
Ep 13400	It 0	Time Elapsed 137.86
Ep 13500	It 0	Time Elapsed 138.03
Ep 13600	It 0	Time Elapsed 137.82
Ep 13700	It 0	Time Elapsed 137.89
Ep 13800	It 0	Time Elapsed 137.06
Ep 13900	It 0	Time Elapsed 138.10
Ep 14000	It 0	Time Elapsed 137.38
Ep 14100	It 0	Time Elapsed 137.89
Ep 14200	It 0	Time Elapsed 137.74
Ep 14300	It 0	Time Elapsed 137.98
Ep 14400	It 0	Time Elapsed 137.11
Ep 14500	It 0	Time Elapsed 135.07
Ep 14600	It 0	Time Elapsed 137.08
Ep 14700	It 0	Time Elapsed 137.20
Ep 14800	It 0	Time Elapsed 136.86
Ep 14900	It 0	Time Elapsed 137.75
Ep 15000	It 0	Time Elapsed 137.94
Ep 15100	It 0	Time Elapsed 137.93
Ep 15200	It 0	Time Elapsed 137.66
Ep 15300	It 0	Time Elapsed 137.78
Ep 15400	It 0	Time Elapsed 138.01
Ep 15500	It 0	Time Elapsed 138.50
Ep 15600	It 0	Time Elapsed 137.81
Ep 15700	It 0	Time Elapsed 138.01
Ep 15800	It 0	Time Elapsed 137.85
Ep 15900	It 0	Time Elapsed 137.92
Ep 16000	It 0	Time Elapsed 138.00
Ep 16100	It 0	Time Elapsed 138.26
Ep 16200	It 0	Time Elapsed 138.17
Ep 16300	It 0	Time Elapsed 138.04
Ep 16400	It 0	Time Elapsed 135.18
Ep 16500	It 0	Time Elapsed 137.96
Ep 16600	It 0	Time Elapsed 138.87
Ep 16700	It 0	Time Elapsed 138.15
Ep 16800	It 0	Time Elapsed 137.37
Ep 16900	It 0	Time Elapsed 137.59
Ep 17000	It 0	Time Elapsed 137.85
Ep 17100	It 0	Time Elapsed 138.32
Ep 17200	It 0	Time Elapsed 137.88
Ep 17300	It 0	Time Elapsed 137.58
Ep 17400	It 0	Time Elapsed 137.85
Ep 17500	It 0	Time Elapsed 137.85
Ep 17600	It 0	Time Elapsed 134.98
Ep 17700	It 0	Time Elapsed 137.99
Ep 17800	It 0	Time Elapsed 138.03
Ep 17900	It 0	Time Elapsed 137.61
Ep 18000	It 0	Time Elapsed 137.33
Ep 18100	It 0	Time Elapsed 137.43
Ep 18200	It 0	Time Elapsed 137.27
Ep 18300	It 0	Time Elapsed 137.62
Ep 18400	It 0	Time Elapsed 137.32
Ep 18500	It 0	Time Elapsed 138.98
Ep 18600	It 0	Time Elapsed 137.20
Ep 18700	It 0	Time Elapsed 135.36
Ep 18800	It 0	Time Elapsed 141.77
Ep 18900	It 0	Time Elapsed 136.73
Ep 19000	It 0	Time Elapsed 135.17
Ep 19100	It 0	Time Elapsed 137.45
Ep 19200	It 0	Time Elapsed 137.34
Ep 19300	It 0	Time Elapsed 138.09
Ep 19400	It 0	Time Elapsed 138.83
Ep 19500	It 0	Time Elapsed 137.97
Ep 19600	It 0	Time Elapsed 137.59
Ep 19700	It 0	Time Elapsed 138.51
Ep 19800	It 0	Time Elapsed 137.46
Ep 19900	It 0	Time Elapsed 137.11
Ep 20000	It 0	Time Elapsed 137.03
Ep 20100	It 0	Time Elapsed 137.09
Ep 20200	It 0	Time Elapsed 137.39
Ep 20300	It 0	Time Elapsed 137.65
Ep 20400	It 0	Time Elapsed 134.82
Ep 20500	It 0	Time Elapsed 137.82
Ep 20600	It 0	Time Elapsed 138.39
Ep 20700	It 0	Time Elapsed 138.22
Ep 20800	It 0	Time Elapsed 137.38
Ep 20900	It 0	Time Elapsed 137.27
Ep 21000	It 0	Time Elapsed 137.58
Ep 21100	It 0	Time Elapsed 139.12
Ep 21200	It 0	Time Elapsed 139.83
Ep 21300	It 0	Time Elapsed 136.38
Ep 21400	It 0	Time Elapsed 138.27
Ep 21500	It 0	Time Elapsed 138.38
Ep 21600	It 0	Time Elapsed 138.38
Ep 21700	It 0	Time Elapsed 138.36
Ep 21800	It 0	Time Elapsed 137.63
Ep 21900	It 0	Time Elapsed 137.17
Ep 22000	It 0	Time Elapsed 137.39
Ep 22100	It 0	Time Elapsed 137.34
Ep 22200	It 0	Time Elapsed 137.54
Ep 22300	It 0	Time Elapsed 137.80
Ep 22400	It 0	Time Elapsed 135.19
Ep 22500	It 0	Time Elapsed 137.52
Ep 22600	It 0	Time Elapsed 137.53
Ep 22700	It 0	Time Elapsed 137.42
Ep 22800	It 0	Time Elapsed 137.78
Ep 22900	It 0	Time Elapsed 137.63
Ep 23000	It 0	Time Elapsed 137.73
Ep 23100	It 0	Time Elapsed 137.48
Ep 23200	It 0	Time Elapsed 137.60
Ep 23300	It 0	Time Elapsed 138.06
Ep 23400	It 0	Time Elapsed 135.29
Ep 23500	It 0	Time Elapsed 138.44
Ep 23600	It 0	Time Elapsed 137.80
Ep 23700	It 0	Time Elapsed 137.79
Ep 23800	It 0	Time Elapsed 137.66
Ep 23900	It 0	Time Elapsed 137.75
Ep 24000	It 0	Time Elapsed 138.09
Ep 24100	It 0	Time Elapsed 138.38
Ep 24200	It 0	Time Elapsed 138.20
Ep 24300	It 0	Time Elapsed 138.44
Ep 24400	It 0	Time Elapsed 135.11
Ep 24500	It 0	Time Elapsed 138.08
Ep 24600	It 0	Time Elapsed 138.23
Ep 24700	It 0	Time Elapsed 138.66
Ep 24800	It 0	Time Elapsed 138.47
Ep 24900	It 0	Time Elapsed 138.47
train	ep 25000	it 000	loss 2.806e-03	ex 60000	time 0.00s
Ep 25000	It 0	Time Elapsed 139.36
============================================================================================================================================
Reconstruction
--------------------------------------------------------------------------------------------------------------------------------------------
Reconstruction Location: /home/alvin/expand-and-cluster/data/sims/ec_a04c4aed4b/seed_-1/main/clustering_a59bb9f70c
--------------------------------------------------------------------------------------------------------------------------------------------

Generating dataset with teacher...
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 0
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 31 of size bigger than 10.0.
removing 31/31 unaligned clusters
Collapsing 0 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':

Final layer size: 0
Traceback (most recent call last):
  File "/home/alvin/expand-and-cluster/EC.py", line 76, in <module>
    main()
  File "/home/alvin/expand-and-cluster/EC.py", line 72, in main
    platform.run_job(runner_registry.get(runner_name).create_from_args(args).run)
  File "/home/alvin/expand-and-cluster/platforms/base.py", line 130, in run_job
    f()
  File "/home/alvin/expand-and-cluster/extraction/runner.py", line 79, in run
    expand_and_cluster.reconstruct(students, losses, self.desc.extraction_path(self.global_seed),
  File "/home/alvin/expand-and-cluster/extraction/expand_and_cluster.py", line 170, in reconstruct
    w_rec, a_rec = reconstruct_layer(w_cat, N, extraction_hparams.gamma, beta, losses, A=a,
  File "/home/alvin/expand-and-cluster/extraction/layer_reconstruction.py", line 116, in reconstruct_layer
    a_reconstructed = np.transpose(np.array(theta[1]), [0, 2, 1])
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/numpy/core/fromnumeric.py", line 655, in transpose
    return _wrapfunc(a, 'transpose', axes)
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/numpy/core/fromnumeric.py", line 59, in _wrapfunc
    return bound(*args, **kwds)
ValueError: axes don't match array
