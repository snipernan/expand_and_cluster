Generating dataset with teacher...
train	ep 00000	it 000	loss 1.099e+01	ex 10000	time 0.00s
train	ep 00100	it 000	loss 2.310e-02	ex 10000	time 9.36s
train	ep 00200	it 000	loss 4.260e-03	ex 10000	time 9.63s
train	ep 00300	it 000	loss 1.194e-03	ex 10000	time 9.63s
train	ep 00400	it 000	loss 3.100e-04	ex 10000	time 10.01s
train	ep 00500	it 000	loss 8.285e-05	ex 10000	time 11.20s
train	ep 00600	it 000	loss 2.899e-05	ex 10000	time 9.96s
train	ep 00700	it 000	loss 1.128e-05	ex 10000	time 9.79s
train	ep 00800	it 000	loss 7.063e-06	ex 10000	time 10.79s
train	ep 00900	it 000	loss 4.976e-06	ex 10000	time 9.76s
train	ep 01000	it 000	loss 1.830e-06	ex 10000	time 10.08s
train	ep 01100	it 000	loss 2.900e-06	ex 10000	time 10.94s
train	ep 01200	it 000	loss 2.526e-06	ex 10000	time 9.95s
train	ep 01300	it 000	loss 1.547e-06	ex 10000	time 10.48s
train	ep 01400	it 000	loss 1.014e-05	ex 10000	time 9.03s
train	ep 01500	it 000	loss 3.179e-06	ex 10000	time 8.10s
============================================================================================================================================
Reconstruction
--------------------------------------------------------------------------------------------------------------------------------------------
Reconstruction Location: /home/alvin/expand-and-cluster/data/sims/ec_161da30716/seed_-1/main/clustering_995dc42cbd
--------------------------------------------------------------------------------------------------------------------------------------------

Generating dataset with teacher...
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 0
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 5 of size bigger than 16.0.
removing 2/5 unaligned clusters
Collapsing 3 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':
#0->1, #1->1, #2->1,
Final layer size: 3

MSE of linear component after reconstruction 0.1949300519775785
Traceback (most recent call last):
  File "/home/alvin/expand-and-cluster/EC.py", line 76, in <module>
    main()
  File "/home/alvin/expand-and-cluster/EC.py", line 72, in main
    platform.run_job(runner_registry.get(runner_name).create_from_args(args).run)
  File "/home/alvin/expand-and-cluster/platforms/base.py", line 130, in run_job
    f()
  File "/home/alvin/expand-and-cluster/extraction/runner.py", line 79, in run
    expand_and_cluster.reconstruct(students, losses, self.desc.extraction_path(self.global_seed),
  File "/home/alvin/expand-and-cluster/extraction/expand_and_cluster.py", line 237, in reconstruct
    teacher_comparison(teacher, students, symmetry, cluster_mask, alignment_reconstruction)
  File "/home/alvin/expand-and-cluster/extraction/expand_and_cluster.py", line 327, in teacher_comparison
    out = compare_with_teacher(wt, bt, at, ws, bs, as_, symmetry, cluster_mask=cluster_mask, verbose=True)
  File "/home/alvin/expand-and-cluster/extraction/layer_reconstruction.py", line 398, in compare_with_teacher
    idx_sorted = np.argsort(np.linalg.norm(at, ord=2, axis=1))[::-1]
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/numpy/linalg/linalg.py", line 2583, in norm
    return sqrt(add.reduce(s, axis=axis, keepdims=keepdims))
numpy.exceptions.AxisError: axis 1 is out of bounds for array of dimension 1
