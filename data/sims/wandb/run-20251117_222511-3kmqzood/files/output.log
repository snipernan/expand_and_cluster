Generating dataset with teacher...
============================================================================================================================================
Reconstruction
--------------------------------------------------------------------------------------------------------------------------------------------
Reconstruction Location: /home/alvin/expand-and-cluster/data/sims/ec_d2cbdbf017/seed_-1/main/clustering_995dc42cbd
--------------------------------------------------------------------------------------------------------------------------------------------

Generating dataset with teacher...
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 0
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 6 of size bigger than 16.0.
removing 2/6 unaligned clusters
Collapsing 4 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':
#0->1, #1->1, #2->1, #3->1,
Final layer size: 4

MSE of linear component after reconstruction 0.1907944763036819
Best average sim w: 7.028809750937444e-09
Best max sim w: 1.4057619401874888e-08
Best average sim a: 1e-16
Best max sim a: 1e-16
Traceback (most recent call last):
  File "/home/alvin/expand-and-cluster/EC.py", line 76, in <module>
    main()
  File "/home/alvin/expand-and-cluster/EC.py", line 72, in main
    platform.run_job(runner_registry.get(runner_name).create_from_args(args).run)
  File "/home/alvin/expand-and-cluster/platforms/base.py", line 130, in run_job
    f()
  File "/home/alvin/expand-and-cluster/extraction/runner.py", line 79, in run
    expand_and_cluster.reconstruct(students, losses, self.desc.extraction_path(self.global_seed),
  File "/home/alvin/expand-and-cluster/extraction/expand_and_cluster.py", line 237, in reconstruct
    teacher_comparison(teacher, students, symmetry, cluster_mask, alignment_reconstruction)
  File "/home/alvin/expand-and-cluster/extraction/expand_and_cluster.py", line 327, in teacher_comparison
    out = compare_with_teacher(wt, bt, at, ws, bs, as_, symmetry, cluster_mask=cluster_mask, verbose=True)
  File "/home/alvin/expand-and-cluster/extraction/layer_reconstruction.py", line 442, in compare_with_teacher
    ax2.bar(range(len(best_sims_a)), best_sims_a)
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/matplotlib/__init__.py", line 1446, in inner
    return func(ax, *map(sanitize_sequence, args), **kwargs)
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/matplotlib/axes/_axes.py", line 2472, in bar
    r = mpatches.Rectangle(
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/matplotlib/_api/deprecation.py", line 454, in wrapper
    return func(*args, **kwargs)
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/matplotlib/patches.py", line 714, in __init__
    super().__init__(**kwargs)
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/matplotlib/_api/deprecation.py", line 454, in wrapper
    return func(*args, **kwargs)
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/matplotlib/patches.py", line 93, in __init__
    self.set_linewidth(linewidth)
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/matplotlib/patches.py", line 394, in set_linewidth
    self._linewidth = float(w)
TypeError: only length-1 arrays can be converted to Python scalars
