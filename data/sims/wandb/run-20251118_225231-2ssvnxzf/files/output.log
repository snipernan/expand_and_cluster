Generating dataset with teacher...
train	ep 00000	it 000	loss 2.916e+01	ex 8000	time 0.00s
train	ep 00100	it 000	loss 1.641e-03	ex 8000	time 8.36s
train	ep 00200	it 000	loss 1.071e-03	ex 8000	time 7.97s
train	ep 00300	it 000	loss 4.262e-04	ex 8000	time 7.04s
train	ep 00400	it 000	loss 1.780e-04	ex 8000	time 6.71s
train	ep 00500	it 000	loss 6.379e-05	ex 8000	time 7.06s
train	ep 00600	it 000	loss 1.741e-05	ex 8000	time 7.00s
train	ep 00700	it 000	loss 1.763e-05	ex 8000	time 6.98s
train	ep 00800	it 000	loss 3.093e-05	ex 8000	time 7.02s
train	ep 00900	it 000	loss 1.630e-05	ex 8000	time 7.05s
train	ep 01000	it 000	loss 2.852e-05	ex 8000	time 7.19s
train	ep 01100	it 000	loss 3.622e-05	ex 8000	time 7.05s
train	ep 01200	it 000	loss 5.709e-05	ex 8000	time 6.85s
train	ep 01300	it 000	loss 1.912e-05	ex 8000	time 6.85s
train	ep 01400	it 000	loss 1.374e-05	ex 8000	time 7.35s
train	ep 01500	it 000	loss 5.599e-05	ex 8000	time 7.90s
train	ep 01600	it 000	loss 9.565e-05	ex 8000	time 7.79s
train	ep 01700	it 000	loss 1.468e-05	ex 8000	time 7.89s
train	ep 01800	it 000	loss 6.493e-05	ex 8000	time 8.49s
train	ep 01900	it 000	loss 2.621e-05	ex 8000	time 8.02s
train	ep 02000	it 000	loss 4.002e-05	ex 8000	time 7.38s
train	ep 02100	it 000	loss 3.298e-05	ex 8000	time 7.26s
train	ep 02200	it 000	loss 3.423e-05	ex 8000	time 7.58s
train	ep 02300	it 000	loss 6.793e-05	ex 8000	time 7.98s
train	ep 02400	it 000	loss 3.029e-05	ex 8000	time 7.30s
train	ep 02500	it 000	loss 3.868e-05	ex 8000	time 7.49s
train	ep 02600	it 000	loss 3.873e-05	ex 8000	time 7.09s
train	ep 02700	it 000	loss 9.271e-06	ex 8000	time 7.63s
train	ep 02800	it 000	loss 7.464e-06	ex 8000	time 6.77s
train	ep 02900	it 000	loss 1.410e-05	ex 8000	time 6.77s
train	ep 03000	it 000	loss 8.174e-05	ex 8000	time 7.07s
train	ep 03100	it 000	loss 3.807e-05	ex 8000	time 7.55s
train	ep 03200	it 000	loss 1.473e-05	ex 8000	time 8.08s
train	ep 03300	it 000	loss 1.157e-05	ex 8000	time 7.40s
train	ep 03400	it 000	loss 7.335e-06	ex 8000	time 7.59s
train	ep 03500	it 000	loss 2.188e-05	ex 8000	time 7.54s
train	ep 03600	it 000	loss 5.010e-05	ex 8000	time 7.25s
train	ep 03700	it 000	loss 9.231e-06	ex 8000	time 6.76s
train	ep 03800	it 000	loss 6.104e-05	ex 8000	time 6.90s
train	ep 03900	it 000	loss 9.768e-06	ex 8000	time 6.83s
train	ep 04000	it 000	loss 1.598e-05	ex 8000	time 6.85s
train	ep 04100	it 000	loss 7.716e-06	ex 8000	time 7.37s
train	ep 04200	it 000	loss 7.045e-05	ex 8000	time 6.81s
train	ep 04300	it 000	loss 3.154e-05	ex 8000	time 6.93s
train	ep 04400	it 000	loss 3.603e-05	ex 8000	time 7.11s
train	ep 04500	it 000	loss 4.997e-05	ex 8000	time 6.87s
train	ep 04600	it 000	loss 1.634e-05	ex 8000	time 6.85s
train	ep 04700	it 000	loss 5.569e-06	ex 8000	time 6.90s
train	ep 04800	it 000	loss 5.511e-05	ex 8000	time 6.77s
train	ep 04900	it 000	loss 3.692e-05	ex 8000	time 6.95s
train	ep 05000	it 000	loss 6.213e-06	ex 8000	time 6.83s
train	ep 05100	it 000	loss 9.982e-06	ex 8000	time 6.79s
train	ep 05200	it 000	loss 2.518e-05	ex 8000	time 6.70s
train	ep 05300	it 000	loss 1.281e-05	ex 8000	time 6.66s
train	ep 05400	it 000	loss 3.615e-06	ex 8000	time 6.57s
train	ep 05500	it 000	loss 1.256e-05	ex 8000	time 6.70s
train	ep 05600	it 000	loss 8.016e-06	ex 8000	time 6.93s
train	ep 05700	it 000	loss 5.344e-06	ex 8000	time 6.77s
train	ep 05800	it 000	loss 4.429e-05	ex 8000	time 6.80s
train	ep 05900	it 000	loss 1.892e-05	ex 8000	time 6.78s
train	ep 06000	it 000	loss 6.469e-06	ex 8000	time 6.98s
train	ep 06100	it 000	loss 5.480e-06	ex 8000	time 6.97s
train	ep 06200	it 000	loss 1.294e-05	ex 8000	time 6.91s
train	ep 06300	it 000	loss 1.103e-05	ex 8000	time 6.84s
train	ep 06400	it 000	loss 2.262e-05	ex 8000	time 7.02s
train	ep 06500	it 000	loss 3.636e-05	ex 8000	time 7.78s
train	ep 06600	it 000	loss 1.799e-05	ex 8000	time 7.58s
train	ep 06700	it 000	loss 1.954e-05	ex 8000	time 7.50s
train	ep 06800	it 000	loss 2.051e-05	ex 8000	time 7.71s
train	ep 06900	it 000	loss 2.660e-06	ex 8000	time 7.91s
train	ep 07000	it 000	loss 7.476e-06	ex 8000	time 7.62s
train	ep 07100	it 000	loss 2.473e-05	ex 8000	time 7.51s
train	ep 07200	it 000	loss 5.900e-05	ex 8000	time 7.50s
train	ep 07300	it 000	loss 1.586e-05	ex 8000	time 7.38s
train	ep 07400	it 000	loss 2.274e-05	ex 8000	time 7.46s
train	ep 07500	it 000	loss 1.735e-05	ex 8000	time 7.24s
train	ep 07600	it 000	loss 1.051e-05	ex 8000	time 7.21s
train	ep 07700	it 000	loss 1.267e-05	ex 8000	time 6.68s
train	ep 07800	it 000	loss 6.664e-05	ex 8000	time 6.88s
train	ep 07900	it 000	loss 7.892e-06	ex 8000	time 6.86s
train	ep 08000	it 000	loss 8.297e-06	ex 8000	time 6.83s
train	ep 08100	it 000	loss 1.098e-05	ex 8000	time 6.70s
train	ep 08200	it 000	loss 8.671e-05	ex 8000	time 6.72s
train	ep 08300	it 000	loss 7.391e-06	ex 8000	time 6.85s
train	ep 08400	it 000	loss 3.918e-05	ex 8000	time 6.74s
train	ep 08500	it 000	loss 1.083e-05	ex 8000	time 6.77s
train	ep 08600	it 000	loss 3.940e-06	ex 8000	time 6.73s
train	ep 08700	it 000	loss 3.392e-05	ex 8000	time 7.55s
train	ep 08800	it 000	loss 1.227e-05	ex 8000	time 7.17s
train	ep 08900	it 000	loss 6.307e-06	ex 8000	time 7.02s
train	ep 09000	it 000	loss 5.419e-05	ex 8000	time 6.32s
train	ep 09100	it 000	loss 1.073e-05	ex 8000	time 6.36s
train	ep 09200	it 000	loss 4.591e-06	ex 8000	time 6.50s
train	ep 09300	it 000	loss 8.059e-06	ex 8000	time 7.05s
train	ep 09400	it 000	loss 3.064e-05	ex 8000	time 8.02s
train	ep 09500	it 000	loss 6.786e-06	ex 8000	time 7.82s
train	ep 09600	it 000	loss 1.760e-05	ex 8000	time 7.78s
train	ep 09700	it 000	loss 2.848e-06	ex 8000	time 7.79s
train	ep 09800	it 000	loss 3.949e-06	ex 8000	time 7.79s
train	ep 09900	it 000	loss 7.957e-06	ex 8000	time 7.67s
train	ep 10000	it 000	loss 8.844e-06	ex 8000	time 7.63s
============================================================================================================================================
Reconstruction
--------------------------------------------------------------------------------------------------------------------------------------------
Reconstruction Location: /home/alvin/expand-and-cluster/data/sims/ec_b372e5aa08/seed_-1/main/clustering_a48fe7727a
--------------------------------------------------------------------------------------------------------------------------------------------

Generating dataset with teacher...
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 0
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 31 of size bigger than 4.0.
removing 22/31 unaligned clusters
Collapsing 9 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':
#0->3, #1->1, #2->1, #3->2, #4->1, #5->1, #6->2, #7->4, #8->2,
Final layer size: 9

train	ep 00000	it 000	loss 1.852e+01	ex 8000	time 0.00s
train	ep 00100	it 000	loss 1.319e-01	ex 8000	time 8.44s
train	ep 00200	it 000	loss 3.941e-02	ex 8000	time 8.00s
train	ep 00300	it 000	loss 1.135e-02	ex 8000	time 8.30s
train	ep 00400	it 000	loss 2.884e-03	ex 8000	time 8.05s
train	ep 00500	it 000	loss 8.832e-04	ex 8000	time 8.19s
train	ep 00600	it 000	loss 5.465e-04	ex 8000	time 8.05s
train	ep 00700	it 000	loss 3.896e-04	ex 8000	time 8.05s
train	ep 00800	it 000	loss 2.638e-04	ex 8000	time 8.66s
train	ep 00900	it 000	loss 1.817e-04	ex 8000	time 7.55s
train	ep 01000	it 000	loss 1.313e-04	ex 8000	time 7.14s
train	ep 01100	it 000	loss 9.876e-05	ex 8000	time 7.05s
train	ep 01200	it 000	loss 6.709e-05	ex 8000	time 7.43s
train	ep 01300	it 000	loss 3.434e-05	ex 8000	time 7.83s
train	ep 01400	it 000	loss 1.695e-05	ex 8000	time 7.77s
train	ep 01500	it 000	loss 9.564e-06	ex 8000	time 7.64s
train	ep 01600	it 000	loss 5.548e-06	ex 8000	time 7.61s
train	ep 01700	it 000	loss 2.857e-06	ex 8000	time 7.87s
train	ep 01800	it 000	loss 1.939e-06	ex 8000	time 7.86s
train	ep 01900	it 000	loss 1.730e-06	ex 8000	time 7.79s
train	ep 02000	it 000	loss 1.493e-06	ex 8000	time 7.97s
train	ep 02100	it 000	loss 1.683e-06	ex 8000	time 7.35s
train	ep 02200	it 000	loss 1.238e-06	ex 8000	time 7.40s
train	ep 02300	it 000	loss 1.029e-06	ex 8000	time 7.53s
train	ep 02400	it 000	loss 9.526e-07	ex 8000	time 7.37s
train	ep 02500	it 000	loss 8.750e-07	ex 8000	time 7.03s
train	ep 02600	it 000	loss 8.475e-07	ex 8000	time 7.18s
train	ep 02700	it 000	loss 6.709e-07	ex 8000	time 7.42s
train	ep 02800	it 000	loss 5.446e-07	ex 8000	time 7.06s
train	ep 02900	it 000	loss 5.381e-07	ex 8000	time 7.58s
train	ep 03000	it 000	loss 4.434e-07	ex 8000	time 8.30s
train	ep 03100	it 000	loss 4.176e-07	ex 8000	time 8.13s
train	ep 03200	it 000	loss 3.740e-07	ex 8000	time 8.26s
train	ep 03300	it 000	loss 4.051e-07	ex 8000	time 8.42s
train	ep 03400	it 000	loss 4.424e-07	ex 8000	time 8.19s
train	ep 03500	it 000	loss 4.360e-07	ex 8000	time 8.01s
train	ep 03600	it 000	loss 3.328e-07	ex 8000	time 8.15s
train	ep 03700	it 000	loss 4.577e-07	ex 8000	time 8.69s
train	ep 03800	it 000	loss 3.517e-07	ex 8000	time 7.55s
train	ep 03900	it 000	loss 3.206e-07	ex 8000	time 7.49s
train	ep 04000	it 000	loss 3.149e-07	ex 8000	time 7.63s
train	ep 04100	it 000	loss 3.377e-07	ex 8000	time 8.24s
train	ep 04200	it 000	loss 2.769e-07	ex 8000	time 7.44s
train	ep 04300	it 000	loss 3.299e-07	ex 8000	time 6.81s
train	ep 04400	it 000	loss 2.942e-07	ex 8000	time 7.03s
train	ep 04500	it 000	loss 2.522e-07	ex 8000	time 6.88s
train	ep 04600	it 000	loss 3.549e-07	ex 8000	time 8.17s
train	ep 04700	it 000	loss 2.760e-07	ex 8000	time 7.39s
train	ep 04800	it 000	loss 2.404e-07	ex 8000	time 9.38s
train	ep 04900	it 000	loss 3.236e-07	ex 8000	time 7.71s
train	ep 05000	it 000	loss 2.329e-07	ex 8000	time 7.88s
--------------------------------------------------------------------------------------------------------------------------------------------
Layer 1
--------------------------------------------------------------------------------------------------------------------------------------------

computing pairwise L2 distances... Done!
Finding tree cut threshold
Extracting clusters
Found 26 of size bigger than 4.0.
removing 26/26 unaligned clusters
Collapsing 0 clusters.
producing dendrogram...
producing simmat...
Collapsing based on best student neuron 'cluster number -> student rank':

Final layer size: 0
Traceback (most recent call last):
  File "/home/alvin/expand-and-cluster/EC.py", line 76, in <module>
    main()
  File "/home/alvin/expand-and-cluster/EC.py", line 72, in main
    platform.run_job(runner_registry.get(runner_name).create_from_args(args).run)
  File "/home/alvin/expand-and-cluster/platforms/base.py", line 130, in run_job
    f()
  File "/home/alvin/expand-and-cluster/extraction/runner.py", line 79, in run
    expand_and_cluster.reconstruct(students, losses, self.desc.extraction_path(self.global_seed),
  File "/home/alvin/expand-and-cluster/extraction/expand_and_cluster.py", line 175, in reconstruct
    w_rec = np.stack([w_rec]*N, axis=2)
  File "/home/alvin/expand-and-cluster/venv/lib/python3.10/site-packages/numpy/core/shape_base.py", line 452, in stack
    axis = normalize_axis_index(axis, result_ndim)
numpy.exceptions.AxisError: axis 2 is out of bounds for array of dimension 2
